# Generated by Django 4.2.20 on 2026-02-19 21:43

import core.models
from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('core', '0001_initial'),
        ('contenttypes', '0002_remove_content_type_name'),
    ]

    operations = [
        migrations.CreateModel(
            name='Adjunto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('object_id', models.UUIDField()),
                ('archivo', models.FileField(upload_to='adjuntos/')),
                ('etiqueta', models.CharField(blank=True, max_length=120)),
            ],
            options={
                'verbose_name': 'Adjunto',
                'verbose_name_plural': 'Adjuntos',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='AlertaAusentismo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo', models.CharField(choices=[('AUSENTISMO_3', '3 días consecutivos'), ('AUSENTISMO_5', '5 días consecutivos'), ('AUSENTISMO_SEMANAL', 'Más del 50% semanal')], max_length=20)),
                ('dias_ausente', models.PositiveIntegerField()),
                ('fecha_inicio_ausencia', models.DateField()),
                ('activa', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Alerta de Ausentismo',
                'verbose_name_plural': 'Alertas de Ausentismo',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='AlertaCiudadano',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo', models.CharField(choices=[('RIESGO_ALTO', 'Riesgo Alto'), ('RIESGO_SUICIDA', 'Riesgo Suicida'), ('VIOLENCIA', 'Situación de Violencia'), ('SIN_CONTACTO', 'Sin Contacto Prolongado'), ('SIN_EVALUACION', 'Sin Evaluación Inicial'), ('SIN_PLAN', 'Sin Plan de Intervención'), ('EVENTO_CRITICO', 'Evento Crítico Reciente'), ('DERIVACION_PENDIENTE', 'Derivación Pendiente'), ('SIN_RED_FAMILIAR', 'Sin Red Familiar'), ('SIN_CONSENTIMIENTO', 'Sin Consentimiento'), ('CONTACTOS_FALLIDOS', 'Contactos Fallidos'), ('PLAN_VENCIDO', 'Plan Vencido')], db_index=True, max_length=30)),
                ('prioridad', models.CharField(choices=[('CRITICA', 'Crítica'), ('ALTA', 'Alta'), ('MEDIA', 'Media'), ('BAJA', 'Baja')], db_index=True, max_length=10)),
                ('mensaje', models.CharField(max_length=200)),
                ('activa', models.BooleanField(db_index=True, default=True)),
                ('fecha_cierre', models.DateTimeField(blank=True, db_index=True, null=True)),
            ],
            options={
                'verbose_name': 'Alerta de Ciudadano',
                'verbose_name_plural': 'Alertas de Ciudadanos',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='AlertaEventoCritico',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('fecha_cierre', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Alerta Evento Crítico',
                'verbose_name_plural': 'Alertas Eventos Críticos',
            },
        ),
        migrations.CreateModel(
            name='CapacitacionPersonal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('nombre_capacitacion', models.CharField(max_length=200)),
                ('institucion_capacitadora', models.CharField(max_length=200)),
                ('fecha_inicio', models.DateField()),
                ('fecha_fin', models.DateField(blank=True, null=True)),
                ('horas_catedra', models.PositiveIntegerField(blank=True, null=True)),
                ('certificado', models.FileField(blank=True, upload_to='capacitaciones/')),
            ],
            options={
                'verbose_name': 'Capacitación de Personal',
                'verbose_name_plural': 'Capacitaciones de Personal',
            },
        ),
        migrations.CreateModel(
            name='CasoInstitucional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('codigo', models.CharField(editable=False, max_length=100, unique=True)),
                ('version', models.PositiveIntegerField(default=1, help_text='Versión del caso (para reaperturas)')),
                ('estado', models.CharField(choices=[('ACTIVO', 'Activo'), ('EN_SEGUIMIENTO', 'En Seguimiento'), ('SUSPENDIDO', 'Suspendido'), ('EGRESADO', 'Egresado'), ('CERRADO', 'Cerrado')], db_index=True, default='ACTIVO', max_length=20)),
                ('fecha_apertura', models.DateField(auto_now_add=True, db_index=True)),
                ('fecha_cierre', models.DateField(blank=True, db_index=True, null=True)),
                ('observaciones', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Caso Institucional',
                'verbose_name_plural': 'Casos Institucionales',
            },
        ),
        migrations.CreateModel(
            name='Ciudadano',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('dni', models.CharField(db_index=True, max_length=20, unique=True)),
                ('nombre', models.CharField(db_index=True, max_length=120)),
                ('apellido', models.CharField(db_index=True, max_length=120)),
                ('fecha_nacimiento', models.DateField(blank=True, db_index=True, null=True)),
                ('genero', models.CharField(blank=True, choices=[('M', 'Masculino'), ('F', 'Femenino'), ('X', 'No binario')], db_index=True, max_length=1)),
                ('telefono', models.CharField(blank=True, db_index=True, max_length=40)),
                ('email', models.EmailField(blank=True, db_index=True, max_length=254)),
                ('domicilio', models.CharField(blank=True, max_length=240)),
                ('activo', models.BooleanField(db_index=True, default=True)),
            ],
            options={
                'verbose_name': 'Ciudadano',
                'verbose_name_plural': 'Ciudadanos',
            },
        ),
        migrations.CreateModel(
            name='Derivacion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('motivo', models.TextField()),
                ('urgencia', models.CharField(choices=[('BAJA', 'Baja'), ('MEDIA', 'Media'), ('ALTA', 'Alta')], db_index=True, default='MEDIA', max_length=20)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('ACEPTADA', 'Aceptada'), ('RECHAZADA', 'Rechazada')], db_index=True, default='PENDIENTE', max_length=20)),
                ('respuesta', models.CharField(blank=True, max_length=120)),
                ('fecha_aceptacion', models.DateField(blank=True, db_index=True, null=True)),
            ],
            options={
                'verbose_name': 'Derivación',
                'verbose_name_plural': 'Derivaciones',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='InscriptoActividad',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('estado', models.CharField(choices=[('INSCRITO', 'Inscrito'), ('ACTIVO', 'Activo'), ('FINALIZADO', 'Finalizado'), ('ABANDONADO', 'Abandonado')], default='INSCRITO', max_length=20)),
                ('fecha_inscripcion', models.DateField(auto_now_add=True)),
                ('fecha_finalizacion', models.DateField(blank=True, null=True)),
                ('observaciones', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Inscripto en Actividad',
                'verbose_name_plural': 'Inscriptos en Actividades',
                'ordering': ['-fecha_inscripcion'],
            },
        ),
        migrations.CreateModel(
            name='LegajoAtencion',
            fields=[
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('codigo', models.CharField(default=core.models.generate_codigo, max_length=36, unique=True)),
                ('estado', models.CharField(choices=[('ABIERTO', 'Abierto'), ('EN_SEGUIMIENTO', 'En seguimiento'), ('DERIVADO', 'Derivado'), ('CERRADO', 'Cerrado')], default='ABIERTO', max_length=20)),
                ('fecha_apertura', models.DateField(auto_now_add=True)),
                ('fecha_cierre', models.DateField(blank=True, null=True)),
                ('confidencialidad', models.CharField(choices=[('NORMAL', 'Normal'), ('RESTRINGIDA', 'Restringida')], default='NORMAL', max_length=20)),
                ('notas', models.TextField(blank=True)),
                ('via_ingreso', models.CharField(choices=[('ESPONTANEA', 'Consulta espontánea'), ('DERIVACION', 'Derivación'), ('JUDICIAL', 'Judicial'), ('HOSPITAL', 'Hospital/Guardia')], db_index=True, default='ESPONTANEA', max_length=20)),
                ('fecha_admision', models.DateField(auto_now_add=True, db_index=True)),
                ('plan_vigente', models.BooleanField(db_index=True, default=False)),
                ('nivel_riesgo', models.CharField(choices=[('BAJO', 'Bajo'), ('MEDIO', 'Medio'), ('ALTO', 'Alto')], db_index=True, default='BAJO', max_length=20)),
                ('ciudadano', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='legajos', to='legajos.ciudadano')),
                ('dispositivo', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='legajos', to='core.institucion', verbose_name='Institución')),
                ('responsable', models.ForeignKey(blank=True, help_text='Usuario con rol de Responsable asignado al legajo', limit_choices_to={'groups__name': 'Responsable'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='legajos_atencion_responsable', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
            ],
            options={
                'verbose_name': 'Acompañamiento',
                'verbose_name_plural': 'Acompañamientos',
            },
        ),
        migrations.CreateModel(
            name='LegajoInstitucional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('codigo', models.CharField(editable=False, max_length=50, unique=True)),
                ('estado_global', models.CharField(choices=[('ACTIVO', 'Activo'), ('OBSERVACION', 'En Observación'), ('SUSPENDIDO', 'Suspendido'), ('CERRADO', 'Cerrado')], db_index=True, default='ACTIVO', help_text='Si es CERRADO, bloquea todos los programas de la institución', max_length=20, verbose_name='Estado Global')),
                ('fecha_apertura', models.DateField(auto_now_add=True)),
                ('fecha_cierre', models.DateField(blank=True, null=True)),
                ('observaciones', models.TextField(blank=True)),
                ('institucion', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='legajo_institucional', to='core.institucion')),
                ('responsable_sedronar', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='legajos_institucionales_responsable', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Legajo Institucional',
                'verbose_name_plural': 'Legajos Institucionales',
            },
        ),
        migrations.CreateModel(
            name='PersonalInstitucion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('nombre', models.CharField(max_length=100)),
                ('apellido', models.CharField(max_length=100)),
                ('dni', models.CharField(max_length=20, unique=True)),
                ('tipo', models.CharField(choices=[('DIRECTOR', 'Director/a'), ('COORDINADOR', 'Coordinador/a'), ('PROFESIONAL', 'Profesional'), ('OPERADOR', 'Operador/a'), ('ADMINISTRATIVO', 'Administrativo/a'), ('OTRO', 'Otro')], max_length=20)),
                ('titulo_profesional', models.CharField(blank=True, max_length=200)),
                ('matricula', models.CharField(blank=True, max_length=50)),
                ('activo', models.BooleanField(default=True)),
                ('legajo_institucional', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='personal', to='legajos.legajoinstitucional')),
                ('usuario', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='personal_institucion', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Personal de Institución',
                'verbose_name_plural': 'Personal de Instituciones',
            },
        ),
        migrations.CreateModel(
            name='PlanFortalecimiento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('nombre', models.CharField(max_length=200)),
                ('tipo', models.CharField(choices=[('PREVENCION', 'Prevención'), ('TRATAMIENTO', 'Tratamiento'), ('REDUCCION_RIESGO', 'Reducción de Riesgo'), ('REINSERCION', 'Reinserción Social'), ('CAPACITACION', 'Capacitación'), ('OTRO', 'Otro')], max_length=20)),
                ('subtipo', models.CharField(choices=[('PREVENCION_UNIVERSAL', 'Prevención Universal'), ('PREVENCION_SELECTIVA', 'Prevención Selectiva'), ('PREVENCION_INDICADA', 'Prevención Indicada'), ('AMBULATORIO', 'Ambulatorio'), ('INTERNACION', 'Internación'), ('HOSPITAL_DIA', 'Hospital de Día'), ('INTERCAMBIO_JERINGAS', 'Intercambio de Jeringas'), ('TESTEO_VIH', 'Testeo VIH'), ('CONSEJERIA', 'Consejería'), ('LABORAL', 'Laboral'), ('EDUCATIVA', 'Educativa'), ('SOCIAL', 'Social'), ('PROFESIONAL', 'Profesional'), ('OPERADORES', 'Operadores'), ('COMUNIDAD', 'Comunidad')], max_length=30)),
                ('descripcion', models.TextField(blank=True)),
                ('cupo_ciudadanos', models.PositiveIntegerField(default=0, help_text='Capacidad máxima de ciudadanos')),
                ('fecha_inicio', models.DateField()),
                ('fecha_fin', models.DateField(blank=True, null=True)),
                ('estado', models.CharField(choices=[('ACTIVO', 'Activo'), ('SUSPENDIDO', 'Suspendido'), ('FINALIZADO', 'Finalizado')], default='ACTIVO', max_length=15)),
                ('legajo_institucional', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='planes_fortalecimiento', to='legajos.legajoinstitucional')),
            ],
            options={
                'verbose_name': 'Actividad Institucional',
                'verbose_name_plural': 'Actividades Institucionales',
            },
        ),
        migrations.CreateModel(
            name='Profesional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('matricula', models.CharField(blank=True, max_length=60)),
                ('rol', models.CharField(blank=True, max_length=80)),
                ('usuario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Profesional',
                'verbose_name_plural': 'Profesionales',
            },
        ),
        migrations.CreateModel(
            name='Programa',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('codigo', models.CharField(db_index=True, max_length=50, unique=True)),
                ('nombre', models.CharField(max_length=200, unique=True)),
                ('tipo', models.CharField(choices=[('ACOMPANAMIENTO_SEDRONAR', 'Acompañamiento SEDRONAR'), ('NACHEC', 'ÑACHEC'), ('ECONOMICO', 'Acompañamiento Económico'), ('FAMILIAR', 'Acompañamiento Familiar'), ('PREVENCION_UNIVERSAL', 'Prevención Universal'), ('REDUCCION_DANOS', 'Reducción de Daños'), ('REINSERCION_SOCIAL', 'Reinserción Social'), ('CAPACITACION_COMUNITARIA', 'Capacitación Comunitaria')], max_length=50, unique=True)),
                ('descripcion', models.TextField(blank=True)),
                ('icono', models.CharField(default='folder', help_text='Nombre del ícono (ej: people, assessment, school)', max_length=50)),
                ('color', models.CharField(default='#6366f1', help_text='Color hex para la UI (ej: #6366f1)', max_length=20)),
                ('orden', models.PositiveIntegerField(default=0, help_text='Orden de visualización en solapas (menor = primero)')),
                ('activo', models.BooleanField(db_index=True, default=True)),
                ('requiere_evaluacion', models.BooleanField(default=True)),
                ('requiere_plan', models.BooleanField(default=True)),
                ('requiere_seguimientos', models.BooleanField(default=True)),
                ('modelo_legajo', models.CharField(blank=True, help_text='Nombre del modelo de legajo (ej: LegajoAtencion, LegajoNachec)', max_length=100)),
            ],
            options={
                'verbose_name': 'Programa',
                'verbose_name_plural': 'Programas',
                'ordering': ['orden', 'nombre'],
            },
        ),
        migrations.CreateModel(
            name='VinculoFamiliar',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo_vinculo', models.CharField(choices=[('PADRE', 'Padre'), ('MADRE', 'Madre'), ('HIJO', 'Hijo/a'), ('HERMANO', 'Hermano/a'), ('ABUELO', 'Abuelo/a'), ('TIO', 'Tío/a'), ('PRIMO', 'Primo/a'), ('PAREJA', 'Pareja'), ('EXPAREJA', 'Ex pareja'), ('CUÑADO', 'Cuñado/a'), ('YERNO', 'Yerno/Nuera'), ('SUEGRO', 'Suegro/a'), ('AMIGO', 'Amigo/a'), ('VECINO', 'Vecino/a'), ('REFERENTE', 'Referente comunitario'), ('TUTOR', 'Tutor legal'), ('OTRO', 'Otro')], max_length=20)),
                ('es_contacto_emergencia', models.BooleanField(default=False, help_text='Disponible para emergencias 24hs')),
                ('es_referente_tratamiento', models.BooleanField(default=False, help_text='Participa activamente en el tratamiento')),
                ('convive', models.BooleanField(default=False, help_text='Vive en el mismo domicilio')),
                ('telefono_alternativo', models.CharField(blank=True, help_text='Teléfono adicional para este vínculo', max_length=40)),
                ('observaciones', models.TextField(blank=True, help_text='Observaciones sobre la relación')),
                ('activo', models.BooleanField(default=True, help_text='Vínculo activo')),
                ('ciudadano_principal', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='vinculos_como_principal', to='legajos.ciudadano')),
                ('ciudadano_vinculado', models.ForeignKey(help_text='Debe ser otro ciudadano registrado en el sistema', on_delete=django.db.models.deletion.CASCADE, related_name='vinculos_como_vinculado', to='legajos.ciudadano')),
            ],
            options={
                'verbose_name': 'Vínculo Familiar',
                'verbose_name_plural': 'Vínculos Familiares',
            },
        ),
        migrations.CreateModel(
            name='StaffActividad',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('rol_en_actividad', models.CharField(help_text='Ej: Coordinador, Terapeuta, Operador', max_length=100)),
                ('activo', models.BooleanField(default=True)),
                ('actividad', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='staff', to='legajos.planfortalecimiento')),
                ('personal', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='legajos.personalinstitucion')),
            ],
            options={
                'verbose_name': 'Staff de Actividad',
                'verbose_name_plural': 'Staff de Actividades',
            },
        ),
        migrations.CreateModel(
            name='SeguimientoContacto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo', models.CharField(choices=[('ENTREVISTA', 'Entrevista'), ('VISITA', 'Visita'), ('LLAMADA', 'Llamada'), ('TALLER', 'Taller')], db_index=True, max_length=40)),
                ('descripcion', models.TextField()),
                ('adherencia', models.CharField(blank=True, choices=[('ADECUADA', 'Adecuada'), ('PARCIAL', 'Parcial'), ('NULA', 'Nula')], db_index=True, max_length=20)),
                ('adjuntos', models.FileField(blank=True, null=True, upload_to='seguimientos/')),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='seguimientos', to='legajos.legajoatencion')),
                ('profesional', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='legajos.profesional')),
            ],
            options={
                'verbose_name': 'Seguimiento',
                'verbose_name_plural': 'Seguimientos',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='RegistroAsistencia',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('fecha', models.DateField()),
                ('estado', models.CharField(choices=[('PRESENTE', 'Presente'), ('AUSENTE', 'Ausente'), ('JUSTIFICADO', 'Ausente Justificado'), ('TARDANZA', 'Tardanza')], max_length=15)),
                ('observaciones', models.TextField(blank=True)),
                ('inscripto', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asistencias', to='legajos.inscriptoactividad')),
                ('registrado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='asistencias_registradas', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Registro de Asistencia',
                'verbose_name_plural': 'Registros de Asistencia',
                'ordering': ['-fecha'],
            },
        ),
        migrations.CreateModel(
            name='ProfesionalTratante',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('rol', models.CharField(choices=[('PSICOLOGO', 'Psicólogo/a'), ('PSIQUIATRA', 'Psiquiatra'), ('MEDICO', 'Médico/a'), ('TS', 'Trabajador/a Social'), ('OPERADOR', 'Operador/a Socioterapéutico'), ('COORDINADOR', 'Coordinador/a'), ('DIRECTOR', 'Director/a'), ('ENFERMERO', 'Enfermero/a'), ('TERAPISTA', 'Terapista Ocupacional'), ('ABOGADO', 'Abogado/a'), ('OTRO', 'Otro')], max_length=20)),
                ('es_responsable_principal', models.BooleanField(default=False, help_text='Responsable principal del caso')),
                ('fecha_asignacion', models.DateField(auto_now_add=True)),
                ('fecha_desasignacion', models.DateField(blank=True, help_text='Fecha cuando dejó de atender el caso', null=True)),
                ('activo', models.BooleanField(default=True)),
                ('observaciones', models.TextField(blank=True, help_text='Observaciones sobre su participación')),
                ('dispositivo', models.ForeignKey(help_text='Dispositivo donde trabaja', on_delete=django.db.models.deletion.PROTECT, to='core.institucion')),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='profesionales_tratantes', to='legajos.legajoatencion')),
                ('usuario', models.ForeignKey(help_text='Usuario del sistema', on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Profesional Tratante',
                'verbose_name_plural': 'Profesionales Tratantes',
            },
        ),
        migrations.CreateModel(
            name='PlanIntervencion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('vigente', models.BooleanField(db_index=True, default=True)),
                ('actividades', models.JSONField(blank=True, help_text='Lista de actividades: [{"accion":"Entrevista","freq":"semanal","responsable":"operador"}]', null=True)),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='planes', to='legajos.legajoatencion')),
                ('profesional', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='legajos.profesional')),
            ],
            options={
                'verbose_name': 'Plan de Intervención',
                'verbose_name_plural': 'Planes de Intervención',
            },
        ),
        migrations.CreateModel(
            name='Objetivo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('descripcion', models.CharField(max_length=240)),
                ('indicador_exito', models.CharField(blank=True, max_length=240)),
                ('cumplido', models.BooleanField(default=False)),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='objetivos', to='legajos.legajoatencion')),
            ],
            options={
                'verbose_name': 'Objetivo',
                'verbose_name_plural': 'Objetivos',
            },
        ),
        migrations.CreateModel(
            name='InstitucionPrograma',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('estado_programa', models.CharField(choices=[('ACTIVO', 'Activo'), ('SUSPENDIDO', 'Suspendido'), ('CERRADO', 'Cerrado')], db_index=True, default='ACTIVO', max_length=20)),
                ('activo', models.BooleanField(db_index=True, default=True, help_text='Si False, no se muestra solapa en UI')),
                ('cupo_maximo', models.PositiveIntegerField(blank=True, help_text='Capacidad máxima de casos simultáneos', null=True)),
                ('controlar_cupo', models.BooleanField(default=False, help_text='Si True, valida cupo al aceptar derivaciones')),
                ('permite_sobrecupo', models.BooleanField(default=False, help_text='Si True, permite aceptar derivaciones con cupo lleno')),
                ('fecha_inicio', models.DateField(blank=True, null=True)),
                ('fecha_fin', models.DateField(blank=True, null=True)),
                ('institucion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='programas_habilitados', to='core.institucion')),
                ('programa', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='instituciones_habilitadas', to='legajos.programa')),
                ('responsable_local', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='institucion_programas_responsable', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Institución-Programa',
                'verbose_name_plural': 'Instituciones-Programas',
            },
        ),
        migrations.AddField(
            model_name='inscriptoactividad',
            name='actividad',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='inscriptos', to='legajos.planfortalecimiento'),
        ),
        migrations.AddField(
            model_name='inscriptoactividad',
            name='ciudadano',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='actividades_inscrito', to='legajos.ciudadano'),
        ),
        migrations.CreateModel(
            name='InscripcionPrograma',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('codigo', models.CharField(db_index=True, editable=False, max_length=100, unique=True)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('ACTIVO', 'Activo'), ('EN_SEGUIMIENTO', 'En Seguimiento'), ('SUSPENDIDO', 'Suspendido'), ('CERRADO', 'Cerrado')], db_index=True, default='PENDIENTE', max_length=20)),
                ('via_ingreso', models.CharField(choices=[('DIRECTO', 'Ingreso Directo'), ('DERIVACION_INTERNA', 'Derivación Interna'), ('DERIVACION_EXTERNA', 'Derivación Externa'), ('ESPONTANEO', 'Espontáneo')], default='DIRECTO', max_length=30)),
                ('fecha_inscripcion', models.DateField(auto_now_add=True, db_index=True)),
                ('fecha_inicio', models.DateField(blank=True, null=True)),
                ('fecha_cierre', models.DateField(blank=True, db_index=True, null=True)),
                ('legajo_id', models.UUIDField(blank=True, help_text='ID del legajo específico del programa', null=True)),
                ('notas', models.TextField(blank=True)),
                ('motivo_cierre', models.TextField(blank=True)),
                ('ciudadano', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='inscripciones_programas', to='legajos.ciudadano')),
                ('programa', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='inscripciones', to='legajos.programa')),
                ('responsable', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='programas_responsable', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Inscripción a Programa',
                'verbose_name_plural': 'Inscripciones a Programas',
                'ordering': ['-fecha_inscripcion'],
            },
        ),
        migrations.CreateModel(
            name='IndicadorInstitucional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('periodo', models.CharField(help_text='Ej: 2024-01, 2024-Q1', max_length=20)),
                ('beneficiarios_atendidos', models.PositiveIntegerField(default=0)),
                ('derivaciones_recibidas', models.PositiveIntegerField(default=0)),
                ('derivaciones_enviadas', models.PositiveIntegerField(default=0)),
                ('servicios_brindados', models.JSONField(blank=True, help_text='Lista de servicios y cantidades', null=True)),
                ('observaciones', models.TextField(blank=True)),
                ('legajo_institucional', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='indicadores', to='legajos.legajoinstitucional')),
            ],
            options={
                'verbose_name': 'Indicador Institucional',
                'verbose_name_plural': 'Indicadores Institucionales',
            },
        ),
        migrations.CreateModel(
            name='HistorialStaff',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('accion', models.CharField(choices=[('ASIGNACION', 'Asignación'), ('DESASIGNACION', 'Desasignación'), ('CAMBIO_ROL', 'Cambio de Rol')], max_length=20)),
                ('descripcion', models.TextField()),
                ('staff', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial', to='legajos.staffactividad')),
                ('usuario', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial de Staff',
                'verbose_name_plural': 'Historiales de Staff',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='HistorialInscripto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('accion', models.CharField(choices=[('INSCRIPCION', 'Inscripción'), ('ACTIVACION', 'Activación'), ('FINALIZACION', 'Finalización'), ('ABANDONO', 'Abandono')], max_length=20)),
                ('descripcion', models.TextField()),
                ('estado_anterior', models.CharField(blank=True, max_length=20)),
                ('inscripto', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial', to='legajos.inscriptoactividad')),
                ('usuario', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial de Inscripto',
                'verbose_name_plural': 'Historiales de Inscriptos',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='HistorialDerivacion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('accion', models.CharField(choices=[('CREACION', 'Creación'), ('ACEPTACION', 'Aceptación'), ('RECHAZO', 'Rechazo')], max_length=20)),
                ('descripcion', models.TextField()),
                ('estado_anterior', models.CharField(blank=True, max_length=20)),
                ('derivacion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial', to='legajos.derivacion')),
                ('usuario', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial de Derivación',
                'verbose_name_plural': 'Historiales de Derivaciones',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='HistorialContacto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo_contacto', models.CharField(choices=[('LLAMADA', 'Llamada Telefónica'), ('EMAIL', 'Email'), ('VISITA_DOM', 'Visita Domiciliaria'), ('REUNION', 'Reunión Presencial'), ('VIDEO', 'Videollamada'), ('MENSAJE', 'Mensaje/WhatsApp')], max_length=20)),
                ('fecha_contacto', models.DateTimeField()),
                ('duracion_minutos', models.PositiveIntegerField(blank=True, help_text='Duración en minutos (para llamadas/reuniones)', null=True)),
                ('estado', models.CharField(choices=[('EXITOSO', 'Exitoso'), ('NO_CONTESTA', 'No contesta'), ('OCUPADO', 'Ocupado'), ('CANCELADO', 'Cancelado'), ('REPROGRAMADO', 'Reprogramado')], default='EXITOSO', max_length=20)),
                ('motivo', models.CharField(help_text='Motivo del contacto', max_length=200)),
                ('resumen', models.TextField(help_text='Resumen de la conversación/encuentro')),
                ('acuerdos', models.TextField(blank=True, help_text='Acuerdos alcanzados')),
                ('proximos_pasos', models.TextField(blank=True, help_text='Próximos pasos acordados')),
                ('participantes', models.TextField(blank=True, help_text='Otras personas presentes (para reuniones/visitas)')),
                ('ubicacion', models.CharField(blank=True, help_text='Ubicación del encuentro', max_length=200)),
                ('archivo_adjunto', models.FileField(blank=True, help_text='Grabación, foto, documento relacionado', null=True, upload_to='contactos/')),
                ('seguimiento_requerido', models.BooleanField(default=False, help_text='Requiere seguimiento posterior')),
                ('fecha_proximo_contacto', models.DateField(blank=True, help_text='Fecha sugerida para próximo contacto', null=True)),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial_contactos', to='legajos.legajoatencion')),
                ('profesional', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='contactos_realizados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial de Contacto',
                'verbose_name_plural': 'Historial de Contactos',
                'ordering': ['-fecha_contacto'],
            },
        ),
        migrations.CreateModel(
            name='HistorialActividad',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('accion', models.CharField(choices=[('CREACION', 'Creación'), ('MODIFICACION', 'Modificación'), ('SUSPENSION', 'Suspensión'), ('FINALIZACION', 'Finalización'), ('REACTIVACION', 'Reactivación')], max_length=20)),
                ('descripcion', models.TextField()),
                ('datos_anteriores', models.JSONField(blank=True, null=True)),
                ('actividad', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial', to='legajos.planfortalecimiento')),
                ('usuario', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial de Actividad',
                'verbose_name_plural': 'Historiales de Actividades',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='EventoCritico',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('tipo', models.CharField(choices=[('SOBREDOSIS', 'Sobredosis'), ('CRISIS', 'Crisis aguda'), ('VIOLENCIA', 'Violencia'), ('INTERNACION', 'Internación')], db_index=True, max_length=40)),
                ('detalle', models.TextField()),
                ('notificado_a', models.JSONField(blank=True, help_text='Lista de familiares/autoridades notificadas', null=True)),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='eventos', to='legajos.legajoatencion')),
            ],
            options={
                'verbose_name': 'Evento Crítico',
                'verbose_name_plural': 'Eventos Críticos',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='EvaluacionInstitucional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('fecha_evaluacion', models.DateField()),
                ('infraestructura', models.PositiveIntegerField(choices=[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10)], help_text='Puntuación 1-10')),
                ('recursos_humanos', models.PositiveIntegerField(choices=[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10)], help_text='Puntuación 1-10')),
                ('programas_servicios', models.PositiveIntegerField(choices=[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10)], help_text='Puntuación 1-10')),
                ('gestion_administrativa', models.PositiveIntegerField(choices=[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10)], help_text='Puntuación 1-10')),
                ('observaciones', models.TextField(blank=True)),
                ('recomendaciones', models.TextField(blank=True)),
                ('evaluador', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('legajo_institucional', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='evaluaciones', to='legajos.legajoinstitucional')),
            ],
            options={
                'verbose_name': 'Evaluación Institucional',
                'verbose_name_plural': 'Evaluaciones Institucionales',
            },
        ),
        migrations.CreateModel(
            name='EvaluacionInicial',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('situacion_consumo', models.TextField(blank=True, help_text='Descripción de la situación actual de consumo', verbose_name='Situación de Consumo')),
                ('antecedentes', models.TextField(blank=True, help_text='Antecedentes médicos, psiquiátricos y de consumo', verbose_name='Antecedentes')),
                ('red_apoyo', models.TextField(blank=True, help_text='Descripción de la red de apoyo familiar y social', verbose_name='Red de Apoyo')),
                ('condicion_social', models.TextField(blank=True, help_text='Situación socioeconómica, vivienda, trabajo, educación', verbose_name='Condición Social')),
                ('tamizajes', models.JSONField(blank=True, help_text='Resultados de tamizajes aplicados (ej: ASSIST, PHQ-9)', null=True, verbose_name='Tamizajes')),
                ('riesgo_suicida', models.BooleanField(db_index=True, default=False, help_text='Indica si presenta riesgo suicida', verbose_name='Riesgo Suicida')),
                ('violencia', models.BooleanField(db_index=True, default=False, help_text='Indica si presenta situación de violencia', verbose_name='Situación de Violencia')),
                ('legajo', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='evaluacion', to='legajos.legajoatencion')),
            ],
            options={
                'verbose_name': 'Evaluación Inicial',
                'verbose_name_plural': 'Evaluaciones Iniciales',
            },
        ),
        migrations.CreateModel(
            name='DispositivoVinculado',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('fecha_admision', models.DateField()),
                ('fecha_egreso', models.DateField(blank=True, null=True)),
                ('estado', models.CharField(choices=[('ACTIVO', 'Activo'), ('EGRESADO', 'Egresado'), ('DERIVADO', 'Derivado'), ('ABANDONO', 'Abandono'), ('SUSPENDIDO', 'Suspendido')], default='ACTIVO', max_length=20)),
                ('observaciones', models.TextField(blank=True, help_text='Observaciones sobre la admisión')),
                ('dispositivo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.institucion')),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='dispositivos_vinculados', to='legajos.legajoatencion')),
                ('referente_dispositivo', models.ForeignKey(blank=True, help_text='Referente en el dispositivo', null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Dispositivo Vinculado',
                'verbose_name_plural': 'Dispositivos Vinculados',
            },
        ),
        migrations.CreateModel(
            name='DerivacionPrograma',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('motivo', models.TextField()),
                ('urgencia', models.CharField(choices=[('BAJA', 'Baja'), ('MEDIA', 'Media'), ('ALTA', 'Alta')], db_index=True, default='MEDIA', max_length=20)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('ACEPTADA', 'Aceptada'), ('RECHAZADA', 'Rechazada'), ('CANCELADA', 'Cancelada')], db_index=True, default='PENDIENTE', max_length=20)),
                ('respuesta', models.TextField(blank=True)),
                ('fecha_respuesta', models.DateTimeField(blank=True, null=True)),
                ('ciudadano', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='derivaciones_programas', to='legajos.ciudadano')),
                ('derivado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_programas_realizadas', to=settings.AUTH_USER_MODEL)),
                ('inscripcion_creada', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivacion_origen', to='legajos.inscripcionprograma')),
                ('inscripcion_origen', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_realizadas', to='legajos.inscripcionprograma')),
                ('programa_destino', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='derivaciones_destino', to='legajos.programa')),
                ('programa_origen', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_origen', to='legajos.programa')),
                ('respondido_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_programas_respondidas', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Derivación entre Programas',
                'verbose_name_plural': 'Derivaciones entre Programas',
                'ordering': ['-creado'],
            },
        ),
        migrations.CreateModel(
            name='DerivacionInstitucional',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('ACEPTADA', 'Aceptada'), ('RECHAZADA', 'Rechazada'), ('ACEPTADA_UNIFICADA', 'Aceptada Unificada')], db_index=True, default='PENDIENTE', max_length=25)),
                ('urgencia', models.CharField(choices=[('BAJA', 'Baja'), ('MEDIA', 'Media'), ('ALTA', 'Alta')], db_index=True, default='MEDIA', max_length=10)),
                ('motivo', models.TextField()),
                ('observaciones', models.TextField(blank=True)),
                ('respuesta', models.TextField(blank=True)),
                ('fecha_respuesta', models.DateTimeField(blank=True, db_index=True, null=True)),
                ('caso_creado', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivacion_creadora', to='legajos.casoinstitucional')),
                ('ciudadano', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='derivaciones_institucionales', to='legajos.ciudadano')),
                ('derivado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_institucionales_realizadas', to=settings.AUTH_USER_MODEL)),
                ('institucion', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='derivaciones_recibidas', to='core.institucion')),
                ('institucion_programa', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='derivaciones', to='legajos.institucionprograma')),
                ('programa', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='derivaciones_programa', to='legajos.programa')),
                ('respondido_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones_institucionales_respondidas', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Derivación Institucional',
                'verbose_name_plural': 'Derivaciones Institucionales',
                'ordering': ['-creado'],
            },
        ),
        migrations.AddField(
            model_name='derivacion',
            name='actividad_destino',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derivaciones', to='legajos.planfortalecimiento', verbose_name='Actividad Específica'),
        ),
        migrations.AddField(
            model_name='derivacion',
            name='destino',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='derivaciones_destino', to='core.institucion', verbose_name='Institución Destino'),
        ),
        migrations.AddField(
            model_name='derivacion',
            name='legajo',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='derivaciones', to='legajos.legajoatencion'),
        ),
        migrations.CreateModel(
            name='CoordinadorPrograma',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('activo', models.BooleanField(db_index=True, default=True, help_text='Si False, el usuario pierde acceso al programa')),
                ('programa', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='coordinadores', to='legajos.programa')),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='programas_coordinados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Coordinador de Programa',
                'verbose_name_plural': 'Coordinadores de Programas',
            },
        ),
        migrations.CreateModel(
            name='ContactoEmergencia',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('nombre', models.CharField(max_length=120)),
                ('relacion', models.CharField(help_text='Relación con el ciudadano', max_length=100)),
                ('telefono_principal', models.CharField(max_length=40)),
                ('telefono_alternativo', models.CharField(blank=True, max_length=40)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('disponibilidad_24hs', models.BooleanField(default=True, help_text='Disponible las 24 horas')),
                ('prioridad', models.PositiveSmallIntegerField(default=1, help_text='Orden de prioridad (1=mayor prioridad)')),
                ('instrucciones_especiales', models.TextField(blank=True, help_text='Instrucciones especiales para contactar')),
                ('activo', models.BooleanField(default=True)),
                ('legajo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contactos_emergencia', to='legajos.legajoatencion')),
            ],
            options={
                'verbose_name': 'Contacto de Emergencia',
                'verbose_name_plural': 'Contactos de Emergencia',
                'ordering': ['prioridad', 'nombre'],
            },
        ),
        migrations.CreateModel(
            name='Consentimiento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado', models.DateTimeField(auto_now_add=True)),
                ('modificado', models.DateTimeField(auto_now=True)),
                ('texto', models.TextField()),
                ('firmado_por', models.CharField(max_length=160)),
                ('fecha_firma', models.DateField()),
                ('archivo', models.FileField(blank=True, null=True, upload_to='consentimientos/')),
                ('vigente', models.BooleanField(default=True)),
                ('ciudadano', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='legajos.ciudadano')),
            ],
            options={
                'verbose_name': 'Consentimiento',
                'verbose_name_plural': 'Consentimientos',
            },
        ),
        migrations.AddIndex(
            model_name='ciudadano',
            index=models.Index(fields=['dni'], name='legajos_ciu_dni_4e1a21_idx'),
        ),
        migrations.AddIndex(
            model_name='ciudadano',
            index=models.Index(fields=['apellido', 'nombre'], name='legajos_ciu_apellid_2efcc7_idx'),
        ),
        migrations.AddIndex(
            model_name='ciudadano',
            index=models.Index(fields=['activo', 'apellido'], name='legajos_ciu_activo_b779fe_idx'),
        ),
        migrations.AddIndex(
            model_name='ciudadano',
            index=models.Index(fields=['email'], name='legajos_ciu_email_e7552c_idx'),
        ),
        migrations.AddField(
            model_name='casoinstitucional',
            name='ciudadano',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='casos_institucionales', to='legajos.ciudadano'),
        ),
        migrations.AddField(
            model_name='casoinstitucional',
            name='institucion_programa',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='casos', to='legajos.institucionprograma'),
        ),
        migrations.AddField(
            model_name='casoinstitucional',
            name='responsable',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='casos_institucionales_responsable', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='capacitacionpersonal',
            name='personal',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='capacitaciones', to='legajos.personalinstitucion'),
        ),
        migrations.AddField(
            model_name='alertaeventocritico',
            name='evento',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertas_vistas', to='legajos.eventocritico'),
        ),
        migrations.AddField(
            model_name='alertaeventocritico',
            name='responsable',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertas_eventos_vistas', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='alertaciudadano',
            name='cerrada_por',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='alertas_cerradas', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='alertaciudadano',
            name='ciudadano',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertas', to='legajos.ciudadano'),
        ),
        migrations.AddField(
            model_name='alertaciudadano',
            name='legajo',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='alertas', to='legajos.legajoatencion'),
        ),
        migrations.AddField(
            model_name='alertaausentismo',
            name='inscripto',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertas_ausentismo', to='legajos.inscriptoactividad'),
        ),
        migrations.AddField(
            model_name='alertaausentismo',
            name='vista_por',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='alertas_ausentismo_vistas', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='adjunto',
            name='content_type',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype'),
        ),
        migrations.AddIndex(
            model_name='vinculofamiliar',
            index=models.Index(fields=['ciudadano_principal', 'activo'], name='legajos_vin_ciudada_12442d_idx'),
        ),
        migrations.AddIndex(
            model_name='vinculofamiliar',
            index=models.Index(fields=['es_contacto_emergencia'], name='legajos_vin_es_cont_ea3d52_idx'),
        ),
        migrations.AddIndex(
            model_name='vinculofamiliar',
            index=models.Index(fields=['es_referente_tratamiento'], name='legajos_vin_es_refe_228ff2_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='vinculofamiliar',
            unique_together={('ciudadano_principal', 'ciudadano_vinculado', 'tipo_vinculo')},
        ),
        migrations.AlterUniqueTogether(
            name='staffactividad',
            unique_together={('actividad', 'personal')},
        ),
        migrations.AddIndex(
            model_name='seguimientocontacto',
            index=models.Index(fields=['legajo', '-creado'], name='legajos_seg_legajo__102aed_idx'),
        ),
        migrations.AddIndex(
            model_name='seguimientocontacto',
            index=models.Index(fields=['tipo'], name='legajos_seg_tipo_878489_idx'),
        ),
        migrations.AddIndex(
            model_name='seguimientocontacto',
            index=models.Index(fields=['adherencia', 'legajo'], name='legajos_seg_adheren_644e29_idx'),
        ),
        migrations.AddIndex(
            model_name='seguimientocontacto',
            index=models.Index(fields=['profesional', '-creado'], name='legajos_seg_profesi_a62371_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='registroasistencia',
            unique_together={('inscripto', 'fecha')},
        ),
        migrations.AddIndex(
            model_name='profesionaltratante',
            index=models.Index(fields=['legajo', 'activo'], name='legajos_pro_legajo__fd356e_idx'),
        ),
        migrations.AddIndex(
            model_name='profesionaltratante',
            index=models.Index(fields=['usuario', 'activo'], name='legajos_pro_usuario_220169_idx'),
        ),
        migrations.AddIndex(
            model_name='profesionaltratante',
            index=models.Index(fields=['es_responsable_principal'], name='legajos_pro_es_resp_2ed784_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='profesionaltratante',
            unique_together={('legajo', 'usuario', 'rol')},
        ),
        migrations.AddIndex(
            model_name='planintervencion',
            index=models.Index(fields=['legajo', 'vigente'], name='legajos_pla_legajo__774a07_idx'),
        ),
        migrations.AddIndex(
            model_name='planintervencion',
            index=models.Index(fields=['profesional', 'vigente'], name='legajos_pla_profesi_0cbb48_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['ciudadano', 'dispositivo'], name='legajos_leg_ciudada_ecfe11_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['estado'], name='legajos_leg_estado_38174b_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['nivel_riesgo', 'fecha_admision'], name='legajos_leg_nivel_r_bb2a9c_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['plan_vigente', 'estado'], name='legajos_leg_plan_vi_489fe2_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['via_ingreso', 'fecha_admision'], name='legajos_leg_via_ing_a35e5d_idx'),
        ),
        migrations.AddIndex(
            model_name='legajoatencion',
            index=models.Index(fields=['dispositivo', 'estado'], name='legajos_leg_disposi_397712_idx'),
        ),
        migrations.AddIndex(
            model_name='institucionprograma',
            index=models.Index(fields=['institucion', 'activo'], name='legajos_ins_institu_5440c0_idx'),
        ),
        migrations.AddIndex(
            model_name='institucionprograma',
            index=models.Index(fields=['programa', 'estado_programa'], name='legajos_ins_program_d4bb01_idx'),
        ),
        migrations.AddIndex(
            model_name='institucionprograma',
            index=models.Index(fields=['estado_programa', 'activo'], name='legajos_ins_estado__44df8b_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='institucionprograma',
            unique_together={('institucion', 'programa')},
        ),
        migrations.AlterUniqueTogether(
            name='inscriptoactividad',
            unique_together={('actividad', 'ciudadano')},
        ),
        migrations.AddIndex(
            model_name='inscripcionprograma',
            index=models.Index(fields=['ciudadano', 'estado'], name='legajos_ins_ciudada_c9810b_idx'),
        ),
        migrations.AddIndex(
            model_name='inscripcionprograma',
            index=models.Index(fields=['programa', 'estado'], name='legajos_ins_program_73dc01_idx'),
        ),
        migrations.AddIndex(
            model_name='inscripcionprograma',
            index=models.Index(fields=['estado', 'fecha_inscripcion'], name='legajos_ins_estado_e7ff4f_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='inscripcionprograma',
            unique_together={('ciudadano', 'programa')},
        ),
        migrations.AlterUniqueTogether(
            name='indicadorinstitucional',
            unique_together={('legajo_institucional', 'periodo')},
        ),
        migrations.AddIndex(
            model_name='historialcontacto',
            index=models.Index(fields=['legajo', '-fecha_contacto'], name='legajos_his_legajo__775928_idx'),
        ),
        migrations.AddIndex(
            model_name='historialcontacto',
            index=models.Index(fields=['tipo_contacto', 'estado'], name='legajos_his_tipo_co_3a29d8_idx'),
        ),
        migrations.AddIndex(
            model_name='historialcontacto',
            index=models.Index(fields=['profesional', '-fecha_contacto'], name='legajos_his_profesi_d278ba_idx'),
        ),
        migrations.AddIndex(
            model_name='historialcontacto',
            index=models.Index(fields=['seguimiento_requerido'], name='legajos_his_seguimi_0fe9a4_idx'),
        ),
        migrations.AddIndex(
            model_name='eventocritico',
            index=models.Index(fields=['legajo', 'tipo'], name='legajos_eve_legajo__746e22_idx'),
        ),
        migrations.AddIndex(
            model_name='eventocritico',
            index=models.Index(fields=['-creado'], name='legajos_eve_creado_f8d037_idx'),
        ),
        migrations.AddIndex(
            model_name='evaluacioninicial',
            index=models.Index(fields=['riesgo_suicida'], name='legajos_eva_riesgo__96eaaf_idx'),
        ),
        migrations.AddIndex(
            model_name='evaluacioninicial',
            index=models.Index(fields=['violencia'], name='legajos_eva_violenc_4ca778_idx'),
        ),
        migrations.AddIndex(
            model_name='dispositivovinculado',
            index=models.Index(fields=['legajo', 'estado'], name='legajos_dis_legajo__2d6cdb_idx'),
        ),
        migrations.AddIndex(
            model_name='dispositivovinculado',
            index=models.Index(fields=['dispositivo', 'estado'], name='legajos_dis_disposi_d191fc_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='dispositivovinculado',
            unique_together={('legajo', 'dispositivo', 'fecha_admision')},
        ),
        migrations.AddIndex(
            model_name='derivacionprograma',
            index=models.Index(fields=['ciudadano', 'estado'], name='legajos_der_ciudada_3ad38b_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacionprograma',
            index=models.Index(fields=['programa_destino', 'estado'], name='legajos_der_program_ac3470_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacionprograma',
            index=models.Index(fields=['estado', 'urgencia'], name='legajos_der_estado_6f16db_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacioninstitucional',
            index=models.Index(fields=['ciudadano', 'estado'], name='legajos_der_ciudada_823ae0_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacioninstitucional',
            index=models.Index(fields=['institucion_programa', 'estado'], name='legajos_der_institu_df6ec4_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacioninstitucional',
            index=models.Index(fields=['estado', 'urgencia'], name='legajos_der_estado_6c8a2d_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacioninstitucional',
            index=models.Index(fields=['institucion', 'programa'], name='legajos_der_institu_601383_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacion',
            index=models.Index(fields=['legajo', 'estado'], name='legajos_der_legajo__77c550_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacion',
            index=models.Index(fields=['urgencia'], name='legajos_der_urgenci_7d080c_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacion',
            index=models.Index(fields=['estado', 'urgencia'], name='legajos_der_estado_20d638_idx'),
        ),
        migrations.AddIndex(
            model_name='derivacion',
            index=models.Index(fields=['destino', 'estado'], name='legajos_der_destino_7b4005_idx'),
        ),
        migrations.AddIndex(
            model_name='coordinadorprograma',
            index=models.Index(fields=['usuario', 'activo'], name='legajos_coo_usuario_c3dedb_idx'),
        ),
        migrations.AddIndex(
            model_name='coordinadorprograma',
            index=models.Index(fields=['programa', 'activo'], name='legajos_coo_program_13967c_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='coordinadorprograma',
            unique_together={('usuario', 'programa')},
        ),
        migrations.AddIndex(
            model_name='contactoemergencia',
            index=models.Index(fields=['legajo', 'activo', 'prioridad'], name='legajos_con_legajo__c0e60f_idx'),
        ),
        migrations.AddIndex(
            model_name='casoinstitucional',
            index=models.Index(fields=['ciudadano', 'estado'], name='legajos_cas_ciudada_f96148_idx'),
        ),
        migrations.AddIndex(
            model_name='casoinstitucional',
            index=models.Index(fields=['institucion_programa', 'estado'], name='legajos_cas_institu_747f58_idx'),
        ),
        migrations.AddIndex(
            model_name='casoinstitucional',
            index=models.Index(fields=['estado', 'fecha_apertura'], name='legajos_cas_estado_5fbb60_idx'),
        ),
        migrations.AddIndex(
            model_name='casoinstitucional',
            index=models.Index(fields=['responsable', 'estado'], name='legajos_cas_respons_b45afe_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='casoinstitucional',
            unique_together={('ciudadano', 'institucion_programa', 'version')},
        ),
        migrations.AddIndex(
            model_name='alertaeventocritico',
            index=models.Index(fields=['responsable', 'fecha_cierre'], name='legajos_ale_respons_7e2a8a_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='alertaeventocritico',
            unique_together={('evento', 'responsable')},
        ),
        migrations.AddIndex(
            model_name='alertaciudadano',
            index=models.Index(fields=['ciudadano', 'activa'], name='legajos_ale_ciudada_b8fddb_idx'),
        ),
        migrations.AddIndex(
            model_name='alertaciudadano',
            index=models.Index(fields=['tipo', 'prioridad'], name='legajos_ale_tipo_3f099f_idx'),
        ),
        migrations.AddIndex(
            model_name='alertaciudadano',
            index=models.Index(fields=['legajo', 'activa'], name='legajos_ale_legajo__34c7e6_idx'),
        ),
        migrations.AddIndex(
            model_name='alertaciudadano',
            index=models.Index(fields=['activa', 'prioridad', '-creado'], name='legajos_ale_activa_6b8b11_idx'),
        ),
        migrations.AddIndex(
            model_name='alertaciudadano',
            index=models.Index(fields=['cerrada_por', 'fecha_cierre'], name='legajos_ale_cerrada_e42828_idx'),
        ),
        migrations.AddIndex(
            model_name='adjunto',
            index=models.Index(fields=['content_type', 'object_id'], name='legajos_adj_content_fdffd8_idx'),
        ),
    ]
